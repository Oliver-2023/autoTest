# Copyright (c) 2011 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

AUTHOR = "Chrome OS Team"
NAME = "Regression"
TIME = "LONG"
TEST_CATEGORY = "Functional"
TEST_CLASS = "suite"
TEST_TYPE = "server"

DOC = """
This test suite runs automated tests that should all pass and that, together
with the control.bvt suite, verify that all major features in the build are
fully functional.  These are meant to run in less than 1 hour.
"""

# List of client tests with parameters
TESTS = [
  ('desktopui_FontCache', {}),
  ('desktopui_GTK2Config', {}),
  ('desktopui_IBusTest', {}),
  ('desktopui_ImeTest', {}),
  ('desktopui_SunSpiderBench', {}),
  ('desktopui_V8Bench', {}),
  ('desktopui_WindowManagerHotkeys', {}),
  ('fsx', {}),
  ('graphics_GLAPICheck', {}),
  ('graphics_SanAngeles', {'creds': '$backdoor'}),
  ('graphics_WindowManagerGraphicsCapture', {}),
  ('hackbench', {}),
  ('hardware_Backlight', {}),
  ('hardware_DiskSize', {}),
  ('hardware_MemoryThroughput', {'num_iteration': 1,
                                 'test_list': '18'}),
  ('hardware_MemoryTotalSize', {}),
  ('hardware_SAT', {'seconds': 20}),
  ('login_BadAuthentication', {'tag' : 'not_verified',
                               'error_string' : 'NotVerified'}),
  ('login_BadAuthentication', {'tag' : 'no_terms',
                               'error_string' : 'TermsNotAgreed'}),
  ('login_BadAuthentication', {'tag' : 'account_deleted',
                               'error_string' : 'AccountDeleted'}),
  ('login_BadAuthentication', {'tag' : 'account_disabled',
                               'error_string' : 'AccountDisabled'}),
  ('login_BadAuthentication', {'tag' : 'service_disabled',
                               'error_string' : 'ServiceDisabled'}),
  ('login_BadAuthentication', {'tag' : 'service_unavailable',
                               'error_string' : 'ServiceUnavailable'}),
  ('login_BadAuthentication', {'tag' : 'unknown',
                               'error_string' : 'Unknown'}),
  ('login_OwnershipNotRetaken', {}),
  ('login_OwnershipRetaken', {}),
  ('login_OwnershipTaken', {}),
  ('login_RemoteOwnership', {}),
  ('login_DBusCalls', {}),
# TODO(kmixter): Fix log volume usage, or change test constraints. See http://crosbug.com/11350
#  ('logging_LogVolume', {'constraints': ['bytes_unexpected <= 100000',
#                                         'files_unexpected <= 50',
#                                         'percent_stateful_used <= 50',
#                                         'percent_unused_patterns <= 70']}),
#
# TODO: Until ltp can pass on chromiumos
#  ('ltp', {}),
  ('network_ConnmanCromoCrash', {}),
  ('network_UdevRename', {}),
  ('platform_AccurateTime', {'constraints': ['seconds_offset < 60']}),
  ('platform_CleanShutdown', {}),
  ('platform_CrosDisksDBus', {}),
  ('platform_DaemonsRespawn', {}),
  ('platform_FileNum', {}),
  ('platform_FileSize', {}),
  ('platform_KernelVersion', {}),
  ('platform_MemCheck', {}),
  ('platform_MiniJailCmdLine', {}),
  ('platform_MiniJailPidNamespace', {}),
  ('platform_MiniJailRootCapabilities', {}),
  ('platform_MiniJailVfsNamespace', {}),
  ('platform_ProcessPrivileges', {}),
  ('platform_Rootdev', {}),
  ('platform_SessionManagerTerm', {}),
  ('platform_TempFS', {}),
  ('platform_ToolchainOptions', {}),
  ('realtimecomm_GTalkAudioBench', {}),
  ('realtimecomm_GTalkunittest', {}),
  ('hardware_SsdDetection', {}, ['has_ssd']),
# TODO(dalecurtis): Re-enable if we ever have any platforms with Bluetooth.
#  ('network_DisableInterface', {'iface_name' : 'hci0',
#                                'tag' : 'hci0'}, ['has_bluetooth']),
  ('network_WiFiCaps', {}, ['has_80211n']),
  ('power_Resume', {}, [], ['has_resume_bug']),
# TODO(dalecurtis): Kernel tests disabled for all platforms until the following
# bugs are fixed:  and http://crosbug.com/14497
#
#  # Disable Kernel crash tests until http://crosbug.com/14497 is fixed.
#  ('platform_KernelErrorPaths', {'host' : 'client'}, [], ['netbook_01b7cc72']),
  ('logging_KernelCrashServer', {'host' : 'client'}, ['has_chromeos_firmware']),
  # Some of the tests in the main regression suite must be run last to prevent
  # cross-test issues. Always add new suites above this line.
  #-----------------------------------------------------------------------------
  # Tests which leave the system in a strange state below. Don't add anything to
  # this section unless you know what you're doing.
  #-----------------------------------------------------------------------------
  # This test stops tcsd which is known to cause issues with cryptohome and
  # possibly other services. Specifically, cros_ui_test based tests will fail;
  # so always run it last. See http://crosbug.com/14265
  ('hardware_TPMCheck', {}, ['has_chromeos_firmware']),
]

job.distribute_across_machines(TESTS, machines)
