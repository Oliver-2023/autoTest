# Copyright 2022 The ChromiumOS Authors
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

from autotest_lib.server import utils

AUTHOR = 'chromeos-bluetooth'
NAME = 'bluetooth_WiFiCoexHealth.independent_reset_test'
PURPOSE = 'Verify the adapter can be reset without affecting WiFi component'
ATTRIBUTES = 'suite:bluetooth_wifi_coex'
TIME = 'short'
TEST_TYPE = 'Server'
DEPENDENCIES = 'wificell, bluetooth'
PY_VERSION = 3

DOC = """
This test verifies the adapter can be reset without affecting WiFi component.

Steps:
1. Connect the DUT to the AP
2. Verify the connection with ping
3. Spawn an asynchronous ping to the background
4. Reset the BT adapter
5. Verify the background ping doesn't fail
"""

args_dict = utils.args_to_dict(args)

def run(machine):
    host = hosts.create_host(machine)
    job.run_test('bluetooth_WiFiCoexHealth', host=host,
                 num_iterations=1, test_name=NAME.split('.')[1])

parallel_simple(run, machines)
