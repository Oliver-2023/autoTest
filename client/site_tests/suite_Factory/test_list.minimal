# -*- coding: utf-8 -*-
#
# Copyright (c) 2010 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# DOCUMENTATION:
#
# Define below an ordered list if tests for execution on factory
# assembly lines.  This list can be customized for specific factory
# needs, within the limits set by the below comments -- specifically,
# ODMs should not remove any Google required tests.
#
# This file is loaded via a call to execfile() in the primary factory
# autotest control file.


# -- CUSTOMIZATION VARIABLES ---------------------------------------
# You can tune these settings to fit your factory process.

# Change this to False if you want and allow fast wipe (insecure).
_DO_FACTORY_SECURE_WIPE = True

# Change this to match your local report upload site.
# You can use a FTP url like: ftp://user:pass@host:port/path/file
# VPD variables NAME=VALUE can be used as %(vpd_NAME).
# Ex: serial=123 => $(vpd_serial).log => 123.log
_REPORT_UPLOAD_METHOD = 'none'  # WARNING: none is ONLY ALLOWED FOR DEBUGGING.
# REPORT UPLOADING IS REQUIRED TO BE SET AT BUILD TIME.
# REPORTS MUST BE PROVIDED TO GOOGLE, MACHINES WITHOUT LOGS CANNOT BE SUPPORTED.

# -- END OF CUSTOMIZATION VARIABLES --------------------------------


# TEST ORDERING: Tests in the test_list will be run in the order
# below, unless the operator interrupts the flow via keyboard
# shortcut.  To cause immediate execution of the run-in tests, for
# example, reorder runin to occur as the first test in the test_list.

TEST_LIST = [

    OperatorTest(
        label_en='start',
        label_zw='開始',
        autotest_name='factory_Dummy',
        kbd_shortcut='e',
        dargs={'quit_key':ord(' '),
               'msg':'Hit SPACE to start testing...\n按 "空白鍵" 開始測試...'}),

    # THIS IS A GOOGLE REQUIRED TEST.
    # YOU MUST TEST THIS COMPONENT, EITHER WITH THIS TEST, OR ANOTHER EQUIVALENT
    # TEST THAT YOU HAVE HAD REVIEWED BY GOOGLE.
    OperatorTest(
        label_en='region',
        label_zw='地區語系',
        autotest_name='factory_SelectRegion',
        kbd_shortcut='j'),

    OperatorTest(
        label_en='serial no',
        label_zw='',
        autotest_name='factory_SetSN',
        kbd_shortcut='6'),

    # THIS IS A GOOGLE REQUIRED TEST.
    # YOU MUST TEST THIS COMPONENT, EITHER WITH THIS TEST, OR ANOTHER EQUIVALENT
    # TEST THAT YOU HAVE HAD REVIEWED BY GOOGLE.
    OperatorTest(
        label_en='devrec',
        label_zw='還原模式',
        autotest_name='factory_DeveloperRecovery',
        kbd_shortcut='b',
        dargs={'layout':'devrec'}),

    # THIS IS A GOOGLE REQUIRED TEST.
    # YOU MUST TEST THIS COMPONENT, EITHER WITH THIS TEST, OR ANOTHER EQUIVALENT
    # TEST THAT YOU HAVE HAD REVIEWED BY GOOGLE.
    AutomatedSequence(
        label_en='HWID',
        label_zw='硬體代號',
        subtest_tag_prefix='hwid',
        kbd_shortcut='h',
        subtest_list=[

            AutomatedSubTest(
                label_en='hw-qual-id matching',
                label_zw='型號匹配',
                autotest_name='factory_ProbeHWID',
                unique_name='hw-qual-id-match'),

            AutomatedSubTest(
                label_en='write GBB',
                label_zw='寫入GBB',
                autotest_name='factory_WriteGBB'),

            AutomatedRebootSubTest(
                label_en='reboot',
                label_zw='重新開機',
                iterations=1),

            # Validation will be made in final stage.
            # If you've got problems, use gooftool to check.
        ]),

    # THIS IS A GOOGLE REQUIRED TEST.
    # PLEASE DO NOT REMOVE THIS TEST IN PRODUCTION RELEASES.
    AutomatedSequence(
        label_en='final',
        label_zw='最終步驟',
        subtest_tag_prefix='finalize',
        kbd_shortcut='f',
        subtest_list=[
            # The pre-flight is to help operators checking if everything is OK.
            # You can remove the step if you want a fully automated process.
            AutomatedSubTest(
                label_en='pre flight',
                label_zw='就緒檢查',
                autotest_name='factory_PreFinalCheck'),
            # The finalize is required for every products.
            # You can't remove this step.
            AutomatedSubTest(
                label_en='finalize',
                label_zw='最終程序',
                autotest_name='factory_Finalize',
                dargs={
                    'check_required_tests': True,
                    'check_and_enable_write_protect': True,
                    'upload_method': _REPORT_UPLOAD_METHOD,
                    'secure_wipe': _DO_FACTORY_SECURE_WIPE,
                })]),
            # NOTE: factory_Finalize.dargs support following variables for
            # temporary testing. You can add these settings to help internal
            # test, but THESE ARE GOOGLE REQUIRED TESTS SO YOU SHOULD NOT
            # DISABLE THEM IN PRODUCTION RELEASES.
            #  - check_required_tests: check if all required tests are passed
            #  - check_and_enable_write_protect: enable and verify flashrom
            #    write protection

    InformationScreen(
        label_en='review',
        label_zw='報告',
        autotest_name='factory_Review',
        unique_name='ReviewInformation',  # REVIEW_INFORMATION_TEST_UNIQUE_NAME
        kbd_shortcut='z'),
]
